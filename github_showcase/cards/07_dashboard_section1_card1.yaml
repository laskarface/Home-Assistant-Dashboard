type: custom:fold-entity-row
padding: 0
clickable: true
card_mod:
  style: 'div#head { display: block !important; width: 100% !important; padding: 0
    !important; margin: 0 !important; --toggle-icon-width: 0px !important; }

    #head { padding: 0 !important; margin: 0 !important; width: 100% !important; cursor:
    pointer !important; }

    #head ha-icon { display: none !important; }

    div#items { padding: 0 !important; margin: 0 !important; }

    '
head:
  type: custom:button-card
  show_name: false
  show_icon: false
  show_state: false
  styles:
    card:
    - padding: 0
    - background: rgba(20, 27, 38, 0.6)
    - backdrop-filter: blur(10px)
    - -webkit-backdrop-filter: blur(10px)
    - border-radius: 20px
    - border: 1px solid rgba(126, 87, 194, 0.4)
    - box-shadow: 0 8px 32px rgba(0,0,0,0.4)
    - height: 85px
    grid:
    - grid-template-areas: '"icon details" "footer footer"'
    - grid-template-columns: 130px minmax(0, 1fr)
    - grid-template-rows: 58px 27px
    custom_fields:
      icon:
      - justify-self: stretch
      - align-self: stretch
      - border-right: 2px solid rgba(255,255,255,0.6)
      - border-top-left-radius: 20px
      - display: flex
      - align-items: center
      - justify-content: center
      details:
      - justify-self: stretch
      - align-self: stretch
      - display: flex
      - flex-direction: column
      - justify-content: center
      - align-items: center
      - padding: 0 10px
  custom_fields:
    icon: "[[[\n  const purple = \"#7E57C2\";\n  const svg = `\n    <svg viewBox=\"\
      0 0 100 100\" width=\"42\" height=\"42\" style=\"filter: drop-shadow(0 4px 8px\
      \ rgba(0,0,0,0.5));\">\n      <defs>\n        <linearGradient id=\"camBody\"\
      \ x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n          <stop offset=\"0%\"\
      \ style=\"stop-color:#ffffff;stop-opacity:1\" />\n          <stop offset=\"\
      100%\" style=\"stop-color:#e0e0e0;stop-opacity:1\" />\n        </linearGradient>\n\
      \        <linearGradient id=\"lensGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"\
      100%\">\n          <stop offset=\"0%\" style=\"stop-color:#1a1a1a;stop-opacity:1\"\
      \ />\n          <stop offset=\"100%\" style=\"stop-color:#000000;stop-opacity:1\"\
      \ />\n        </linearGradient>\n      </defs>\n      <!-- Bracket -->\n   \
      \   <path d=\"M50,65 L50,80 M40,80 L60,80\" stroke=\"#ccc\" stroke-width=\"\
      4\" stroke-linecap=\"round\" />\n      <!-- Camera Body -->\n      <rect x=\"\
      25\" y=\"25\" width=\"50\" height=\"40\" rx=\"10\" ry=\"10\" fill=\"url(#camBody)\"\
      \ />\n      <!-- Lens Glass -->\n      <circle cx=\"50\" cy=\"45\" r=\"15\"\
      \ fill=\"#222\" />\n      <circle cx=\"50\" cy=\"45\" r=\"10\" fill=\"url(#lensGrad)\"\
      \ />\n      <!-- Reflections -->\n      <circle cx=\"46\" cy=\"41\" r=\"3\"\
      \ fill=\"#4dabf7\" opacity=\"0.3\" filter=\"blur(1px)\" />\n      <!-- LED -->\n\
      \      <circle cx=\"68\" cy=\"33\" r=\"1.5\" fill=\"#00E676\" style=\"animation:\
      \ blinkLED 2s infinite;\" />\n      <style>@keyframes blinkLED { 0%, 100% {\
      \ opacity: 1; } 50% { opacity: 0.3; } }</style>\n    </svg>\n  `;\n  return\
      \ `\n    <div style=\"width: 100%; height: 100%; display: flex; flex-direction:\
      \ column; align-items: center; justify-content: center; background: linear-gradient(135deg,\
      \ ${purple}33 0%, ${purple}0D 100%); border-top-left-radius: 20px; position:\
      \ relative;\">\n      <div style=\"position: absolute; width: 50px; height:\
      \ 50px; background: ${purple}; border-radius: 50%; filter: blur(20px); opacity:\
      \ 0.3; animation: pulseGlow 4s infinite alternate ease-in-out;\"></div>\n  \
      \    <div style=\"position: relative; z-index: 1;\">${svg}</div>\n      <div\
      \ style=\"font-size: 10px; font-weight: 900; color: white; text-transform: uppercase;\
      \ letter-spacing: 0.8px; margin-top: -8px; z-index: 1;\">Caméras</div>\n   \
      \   <style>@keyframes pulseGlow { from { opacity: 0.2; transform: scale(0.9);\
      \ } to { opacity: 0.4; transform: scale(1.1); } }</style>\n    </div>\n  `;\n\
      ]]]\n"
    details: "[[[\n  const batPortail = states['sensor.camera_portail_batterie']?.state\
      \ || '?';\n  const batBal = states['sensor.camera_boite_a_lettre_batterie']?.state\
      \ || '?';\n  const getCol = (s) => (parseInt(s) > 20 ? \"#00C853\" : \"#E53935\"\
      );\n\n  return `\n    <div style=\"display: flex; flex-direction: column; width:\
      \ 100%; height: 100%; align-items: center; justify-content: center; text-align:\
      \ center;\">\n      <div style=\"font-size: 13px; font-weight: 800; color: white;\
      \ text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px;\">Extérieures</div>\n\
      \      <div style=\"display: flex; gap: 15px; align-items: center; justify-content:\
      \ center;\">\n        <div style=\"font-size: 10px; color: rgba(255,255,255,0.6);\
      \ font-weight: 600;\">PORTAIL: <span style=\"color: ${getCol(batPortail)}; font-weight:\
      \ 800;\">${batPortail}%</span></div>\n        <div style=\"font-size: 10px;\
      \ color: rgba(255,255,255,0.6); font-weight: 600;\">BAL: <span style=\"color:\
      \ ${getCol(batBal)}; font-weight: 800;\">${batBal}%</span></div>\n      </div>\n\
      \    </div>\n  `;\n]]]\n"
    footer: '[[[ return `<div style="display:flex; width:100%; justify-content:center;
      padding: 5px;"><ha-icon icon="mdi:chevron-down" style="color:rgba(255,255,255,0.5);
      width:18px;"></ha-icon></div>`; ]]]

      '
entities:
- type: custom:mod-card
  card_mod:
    style: 'ha-card { margin: 15px 10px; background: transparent; border: none; }

      '
  card:
    type: grid
    columns: 2
    square: false
    cards:
    - type: vertical-stack
      cards:
      - type: custom:button-card
        name: ACTIVER
        icon: mdi:play
        show_icon: true
        tap_action:
          action: call-service
          service: button.press
          target:
            entity_id: button.portail_start_rtsp_stream
        styles:
          card:
          - background: rgba(0, 200, 83, 0.2)
          - border: 1px solid rgba(0, 200, 83, 0.4)
          - border-radius: 8px
          - height: 40px
          - margin-bottom: 8px
          name:
          - font-size: 11px
          - font-weight: 800
          - color: white
          icon:
          - color: '#00C853'
          - width: 18px
      - type: custom:button-card
        entity: image.portail_event_image
        show_entity_picture: true
        show_name: false
        tap_action:
          action: more-info
          entity: camera.camera_portail
        styles:
          card:
          - height: 120px
          - border-radius: 12px
          - border: 1px solid rgba(255, 255, 255, 0.1)
          - overflow: hidden
          entity_picture:
          - width: 100%
          - height: 100%
          - object-fit: cover
    - type: vertical-stack
      cards:
      - type: custom:button-card
        name: ACTIVER
        icon: mdi:play
        show_icon: true
        tap_action:
          action: call-service
          service: button.press
          target:
            entity_id: button.boite_a_lettres_start_rtsp_stream
        styles:
          card:
          - background: rgba(0, 200, 83, 0.2)
          - border: 1px solid rgba(0, 200, 83, 0.4)
          - border-radius: 8px
          - height: 40px
          - margin-bottom: 8px
          name:
          - font-size: 11px
          - font-weight: 800
          - color: white
          icon:
          - color: '#00C853'
          - width: 18px
      - type: custom:button-card
        entity: image.boite_a_lettres_event_image
        show_entity_picture: true
        show_name: false
        tap_action:
          action: more-info
          entity: camera.camera_boite_a_lettres
        styles:
          card:
          - height: 120px
          - border-radius: 12px
          - border: 1px solid rgba(255, 255, 255, 0.1)
          - overflow: hidden
          entity_picture:
          - width: 100%
          - height: 100%
          - object-fit: cover
