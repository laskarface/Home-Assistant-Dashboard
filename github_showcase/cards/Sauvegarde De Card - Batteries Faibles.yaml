type: conditional
conditions:
- entity: sensor.batteries_faibles_count
  state_not: '0'
card:
  type: custom:button-card
  entity: sensor.batteries_faibles_count
  name: Batteries Faibles
  icon: mdi:battery-alert
  label: Appareils à changer
  show_name: true
  show_icon: true
  show_label: true
  tap_action:
    action: navigate
    navigation_path: /lovelace/batteries
  custom_fields:
    s: '[[[ return entity.state; ]]]

      '
  variables:
    color: '#ff4444'
  styles:
    card:
    - background: rgba(20, 27, 38, 0.6)
    - backdrop-filter: blur(20px)
    - -webkit-backdrop-filter: blur(20px)
    - border-radius: 20px
    - padding: 8px
    - height: 65px
    - box-shadow: '[[[ return `0 0 20px ${variables.color}80, 0 8px 32px rgba(0,0,0,0.3)`;
        ]]]

        '
    - border: '[[[ return `1px solid ${variables.color}80`; ]]]

        '
    - transition: box-shadow 0.8s ease-in-out, border 0.8s ease-in-out
    grid:
    - grid-template-areas: '"i n s" "i l s"'
    - grid-template-columns: 50px 1fr auto
    - grid-template-rows: 1fr 1fr
    icon:
    - color: '[[[ return variables.color; ]]]'
    - width: 30px
    - height: 30px
    - filter: '[[[ return `drop-shadow(0 0 5px ${variables.color}66)`; ]]]'
    name:
    - font-size: 14px
    - font-weight: 700
    - color: white
    - justify-self: start
    - align-self: end
    label:
    - font-size: 11px
    - color: rgba(255,255,255,0.7)
    - justify-self: start
    - align-self: start
    custom_fields:
      s:
      - font-size: 32px
      - font-weight: 900
      - color: '[[[ return variables.color; ]]]'
      - align-self: center
      - margin-right: 16px
      - text-shadow: '[[[ return `0 0 10px ${variables.color}4d`; ]]]'
  card_mod:
    style: "/* Force le clignotement synchronisé sur l'icône et tout le texte */\n\
      ha-icon, #name, #label, #s {\n  animation: blink 2s infinite !important;\n}\n\
      @keyframes blink {\n  0% { opacity: 1; }\n  50% { opacity: 0.3; }\n  100% {\
      \ opacity: 1; }\n}\n"
